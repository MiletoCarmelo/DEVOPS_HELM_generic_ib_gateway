# templates/configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "ib-gateway.fullname" . }}-config
  labels:
    {{- include "ib-gateway.labels" . | nindent 4 }}
data:
  # Configuration existante
  TWS_PORT: "{{ .Values.port }}"
  API_PORT: "{{ .Values.apiPort }}"
  TRADING_MODE: "{{ .Values.mode }}"
  TZ: "{{ .Values.timezone }}"
  LOG_LEVEL: "{{ .Values.logging.level }}"
  {{- if .Values.security.autoRestartOnDisconnect }}
  IBC_AUTO_RESTART_ON_DISCONNECT: "yes"
  {{- end }}
  {{- if .Values.vnc.enabled }}
  VNC_SERVER_PASSWORD: "{{ .Values.vnc.password }}"
  {{- end }}
  
---
# Deuxi√®me ConfigMap (nouveau, avec un nom statique)
apiVersion: v1
kind: ConfigMap
metadata:
  name: ib-gateway-files-config  # Nom statique
  labels:
    {{- include "ib-gateway.labels" . | nindent 4 }}
data:
  jts.ini.tmpl: {{ .Files.Get "config/ibgateway/jts.ini.tmpl" | quote }}
  config.ini.tmpl: {{ .Files.Get "config/ibc/config.ini.tmpl" | quote }}

